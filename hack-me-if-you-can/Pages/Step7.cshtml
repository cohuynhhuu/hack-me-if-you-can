@page
@model Step7Model
@{ ViewData["Title"] = "STEP 7: Input Validation"; }
<div class="container mt-4">
<div class="row mb-4">
<div class="col-12"><div class="d-flex justify-content-between align-items-center">
<h2><i class="bi bi-7-circle-fill text-success"></i> STEP 7: Input Validation</h2>
<a href="/" class="btn btn-outline-secondary"><i class="bi bi-house"></i> Dashboard</a>
</div></div></div>
<div class="row">
<div class="col-md-6"><div class="demo-section vulnerable-section">
<h4 class="text-danger"><i class="bi bi-exclamation-triangle-fill"></i> Vulnerable</h4>
<p><strong>Problem:</strong> No validation on user inputs</p>
<form onsubmit="testValidationVulnerable(event)">
<input type="text" class="form-control mb-3" id="vulnEmail" placeholder="Email (any text accepted)">
<button type="submit" class="btn btn-vulnerable w-100"><i class="bi bi-bug-fill"></i> Submit (No Validation)</button>
</form>
<div id="vulnValidResult" class="result-panel"></div>
</div></div>
<div class="col-md-6"><div class="demo-section secure-section">
<h4 class="text-success"><i class="bi bi-shield-check-fill"></i> Secure</h4>
<p><strong>Solution:</strong> FluentValidation + Data Annotations</p>
<form onsubmit="testValidationSecure(event)">
<input type="text" class="form-control mb-3" id="secureEmail" placeholder="Email (validated)">
<button type="submit" class="btn btn-secure w-100"><i class="bi bi-shield-fill"></i> Submit (Validated)</button>
</form>
<div id="secureValidResult" class="result-panel"></div>
</div></div></div>
<div class="row mt-4"><div class="col-12"><div class="highlight-box highlight-info">
<h5><i class="bi bi-info-circle-fill"></i> Validation Layers</h5>
<ul class="mb-0">
<li>Client-side: HTML5 + JavaScript</li>
<li>Server-side: FluentValidation or Data Annotations</li>
<li>Whitelist inputs (allow known good)</li>
<li>Reject malicious patterns</li>
</ul></div></div></div></div>
@section Scripts {
<script>
function testValidationVulnerable(e) {
    e.preventDefault();
    const val = document.getElementById('vulnEmail').value;
    showResult('vulnValidResult', 'warning', 'Accepted: "' + val + '" - no validation!');
}
function testValidationSecure(e) {
    e.preventDefault();
    const val = document.getElementById('secureEmail').value;
    const emailPattern = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;
    const isValid = emailPattern.test(val);
    if(isValid) showResult('secureValidResult', 'success', 'Valid email accepted');
    else showResult('secureValidResult', 'error', 'Invalid email rejected');
}
</script>
}
